import { useEffect, useState } from "react";
import style from "./FavoriteButton.module.css";
import {
  getFavoriteById,
  toggleFavoriteInLocalStorage,
} from "../../utils/localstorage";

type FavoriteButtonProps = {
  id: string;
};

export const FavoriteButton = ({ id }: FavoriteButtonProps) => {
  const [isFavorited, setIsFavorited] = useState<boolean>(false);

  useEffect(() => {
    setIsFavorited(getFavoriteById(id));
  }, []);

  function toggleFavorite() {
    toggleFavoriteInLocalStorage(id);
    setIsFavorited(!isFavorited);
  }

  return (
    <button className={style.favorite_button} onClick={toggleFavorite}>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="29"
        height="28"
        viewBox="0 0 29 28"
        fill="none"
      >
        <path
          className={
            isFavorited
              ? style.favorite_button__red
              : style.favorite_button__black
          }
          id="â¡"
          d="M14.6718 27.1394C11.6237 24.8834 9.06775 22.7954 7.00375 20.8754C4.93975 18.9554 3.30775 16.9994 2.10775 15.0074C0.93175 13.0154 0.34375 10.9874 0.34375 8.92338C0.34375 7.38738 0.66775 6.00738 1.31575 4.78338C1.96375 3.55938 2.85175 2.59938 3.97975 1.90337C5.13175 1.20737 6.42775 0.859375 7.86775 0.859375C9.59575 0.859375 11.0358 1.29138 12.1877 2.15538C13.3398 3.01938 14.1678 3.91938 14.6718 4.85537C15.1518 3.91938 15.9678 3.01938 17.1198 2.15538C18.2957 1.29138 19.7478 0.859375 21.4758 0.859375C22.9158 0.859375 24.1998 1.20737 25.3278 1.90337C26.4798 2.59938 27.3798 3.55938 28.0278 4.78338C28.6758 6.00738 28.9998 7.38738 28.9998 8.92338C28.9998 10.9874 28.3998 13.0154 27.1998 15.0074C26.0238 16.9994 24.4038 18.9674 22.3398 20.9114C20.2758 22.8314 17.7198 24.9074 14.6718 27.1394ZM15.1037 23.6474C17.6478 21.6314 19.6998 19.8794 21.2598 18.3914C22.8198 16.9034 24.0438 15.3794 24.9318 13.8194C25.8198 12.2594 26.2638 10.6154 26.2638 8.88737C26.2638 7.25537 25.8318 5.95938 24.9678 4.99938C24.1278 4.03937 22.9878 3.55937 21.5478 3.55937C20.5398 3.55937 19.6158 3.79938 18.7758 4.27938C17.9598 4.73538 17.2278 5.37138 16.5798 6.18738C15.9318 7.00337 15.2958 8.03537 14.6718 9.28337C14.0478 8.03537 13.4118 7.00337 12.7638 6.18738C12.1158 5.37138 11.3717 4.73538 10.5317 4.27938C9.71575 3.79938 8.80375 3.55937 7.79575 3.55937C6.83575 3.55937 5.99575 3.77537 5.27575 4.20738C4.57975 4.63938 4.03975 5.26337 3.65575 6.07937C3.27175 6.89538 3.07975 7.83138 3.07975 8.88737C3.07975 10.6394 3.53575 12.3194 4.44775 13.9274C5.38375 15.5114 6.64375 17.0594 8.22775 18.5714C9.83575 20.0594 11.9838 21.8594 14.6718 23.9714L15.1037 23.6474Z"
          fill="#2D2D2D"
        />
      </svg>
    </button>
  );
};
