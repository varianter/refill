---
import Accordion from "../components/Accordion.vue";
import SpeakerCard from "../components/SpeakerCard.astro";
import Toggle from "../components/Toggle.astro";
import Track from "../components/Track.astro";
import ScheduleLayout from "../layouts/ScheduleLayout.astro";
import {
  getShortestTalkDuration,
  getSlotsAvaliable,
  schedule,
} from "../utils/schedule";
---

<ScheduleLayout>
  <div class="schedule__flex">
    <h1 class="schedule__heading">Schedule</h1>
    <Toggle text="Favorites" />
  </div>
  {
    schedule.map((block) => {
      if (block.tracks.length > 1 || block.tracks[0].length > 1) {
        return (
          <Accordion
            client:visible
            title={block.title}
            startTime={block.start}
            endTime={block.end}
            id={1}
          >
            {block.tracks.map((track) => {
              if (block.tracks[0].length > 1) {
                return (
                  <Track
                    track={track}
                    numberOfRows={getSlotsAvaliable(block)}
                    shortestTime={getShortestTalkDuration(block)}
                  />
                );
              } else {
                return (
                  <Track
                    track={track}
                    numberOfRows={1}
                    shortestTime={getShortestTalkDuration(block)}
                  />
                );
              }
            })}
          </Accordion>
        );
      } else {
        const singleTrack = block.tracks[0][0];
        return (
          <div class="schedule__speaker_card">
            <SpeakerCard
              id={singleTrack.id}
              speakerName={singleTrack.speaker}
              colorPair={singleTrack.color}
              talk={singleTrack.title}
              discipline={`${singleTrack.location} ${singleTrack.from}-${singleTrack.to}`}
            />
          </div>
        );
      }
    })
  }
</ScheduleLayout>

<style>
  .schedule__flex {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .schedule__heading {
    font-size: 4.5rem;

    @media (max-width: 1000px) {
      font-size: 3.5rem;
    }

    @media (max-width: 530px) {
      font-size: 2rem;
    }
  }

  .schedule__flex,
  .schedule__speaker_card {
    width: 100%;
    max-width: 1410px;
    margin: auto;
  }
</style>
